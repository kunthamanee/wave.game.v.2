<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>üöÄ Space Wave Shooter</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Arial", sans-serif;
      background: radial-gradient(ellipse at center, #1a0033 0%, #000 70%);
      color: #00ffff;
      text-align: center;
      overflow: hidden;
      position: relative;
    }
    
    /* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏î‡∏≤‡∏ß‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á */
    .stars {
      position: absolute;
      width: 100%;
      height: 100%;
      z-index: -1;
    }
    .star {
      position: absolute;
      background: white;
      border-radius: 50%;
      animation: twinkle 2s infinite alternate;
    }
    
    @keyframes twinkle {
      0% { opacity: 0.3; transform: scale(1); }
      100% { opacity: 1; transform: scale(1.2); }
    }
    
    canvas {
      display: block;
      margin: 0 auto;
      border-radius: 15px;
      background: radial-gradient(circle at center, #000033 0%, #000011 100%);
      box-shadow: 0 0 40px rgba(0, 255, 255, 0.3), inset 0 0 20px rgba(0, 0, 100, 0.3);
      border: 2px solid rgba(0, 255, 255, 0.5);
    }
    
    h1 {
      margin: 15px 0;
      text-shadow: 0 0 20px rgba(0, 255, 255, 0.8);
      font-size: 2em;
      letter-spacing: 2px;
    }
    
    .hud {
      margin: 15px;
      font-size: 18px;
      text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
      display: flex;
      justify-content: center;
      gap: 30px;
      flex-wrap: wrap;
    }
    
    .hud-item {
      background: rgba(0, 50, 100, 0.7);
      padding: 8px 15px;
      border-radius: 20px;
      border: 1px solid rgba(0, 255, 255, 0.3);
    }
    
    .btn {
      padding: 15px 25px;
      margin: 10px;
      border: none;
      border-radius: 30px;
      font-weight: bold;
      cursor: pointer;
      background: linear-gradient(145deg, #003366, #0066cc);
      color: #00ffff;
      box-shadow: 0 5px 20px rgba(0, 100, 200, 0.4);
      transition: all 0.3s ease;
      border: 2px solid rgba(0, 255, 255, 0.3);
      font-size: 16px;
    }
    
    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0, 150, 255, 0.6);
      background: linear-gradient(145deg, #0066cc, #0099ff);
    }
    
    .correct {
      background: linear-gradient(145deg, #00ff88, #00cc66) !important;
      color: #000 !important;
      animation: pulse 0.6s ease-in-out;
      border-color: #00ff88 !important;
    }
    
    .wrong {
      background: linear-gradient(145deg, #ff3366, #cc0033) !important;
      color: #fff !important;
      animation: shake 0.6s ease-in-out;
      border-color: #ff3366 !important;
    }
    
    .screen-overlay {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 20, 40, 0.95);
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 0 50px rgba(0, 255, 255, 0.8);
      border: 2px solid rgba(0, 255, 255, 0.5);
      max-width: 90%;
      max-height: 90%;
      overflow-y: auto;
    }
    
    .boss-screen {
      background: rgba(100, 0, 100, 0.95) !important;
      box-shadow: 0 0 50px rgba(255, 0, 255, 0.8) !important;
      border-color: rgba(255, 0, 255, 0.5) !important;
    }
    
    .boss-questions {
      text-align: left;
      margin: 20px 0;
    }
    
    .question {
      background: rgba(0, 50, 100, 0.5);
      padding: 15px;
      margin: 10px 0;
      border-radius: 10px;
      border-left: 4px solid #00ffff;
    }
    
    .boss-health {
      width: 100%;
      height: 20px;
      background: rgba(100, 0, 0, 0.5);
      border-radius: 10px;
      margin: 15px 0;
      position: relative;
      overflow: hidden;
    }
    
    .boss-health-bar {
      height: 100%;
      background: linear-gradient(90deg, #ff0066, #ff3399);
      border-radius: 10px;
      transition: width 0.5s ease;
      box-shadow: 0 0 20px rgba(255, 0, 102, 0.8);
    }
    
    .knowledge-panel {
      text-align: left;
      background: rgba(0, 30, 60, 0.8);
      padding: 20px;
      border-radius: 15px;
      margin: 20px 0;
      border: 1px solid rgba(0, 255, 255, 0.3);
    }
    
    .formula {
      background: rgba(0, 50, 100, 0.6);
      padding: 10px;
      border-radius: 8px;
      font-family: monospace;
      font-size: 18px;
      text-align: center;
      margin: 10px 0;
      border: 1px solid rgba(0, 255, 255, 0.4);
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-8px); }
      75% { transform: translateX(8px); }
    }
  </style>
</head>
<body>
  <!-- ‡∏î‡∏≤‡∏ß‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á -->
  <div class="stars" id="starsContainer"></div>
  
  <h1>üöÄ Space Wave Shooter üåå</h1>
  <canvas id="gameCanvas" width="800" height="700"></canvas>
  
  <div class="hud">
    <div class="hud-item">‚ö° Score: <span id="score">0</span></div>
    <div class="hud-item">üíñ Lives: <span id="lives">5</span></div>
    <div class="hud-item">üåå Wave: <span id="waveCount">1</span></div>
    <div class="hud-item">üëæ Defeated: <span id="totalDefeated">0</span></div>
  </div>
  
  <div id="controls"></div>
  <div id="gameScreen"></div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    
    const W = canvas.width;
    const H = canvas.height;
    const ROCKET_X = W / 2;
    const ROCKET_Y = H - 80;
    
    let gameState = {
      score: 0,
      lives: 5,
      frequency: 10,
      currentEnemy: null,
      answered: false,
      totalDefeated: 0,
      waves: [],
      particles: [],
      gameStarted: false,
      gameEnded: false,
      animTime: 0,
      bossMode: false,
      bossHealth: 3,
      bossQuestions: [],
      currentBossQuestion: 0,
      planets: [],
      nebula: []
    };
    
    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡∏≤‡∏ß‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á
    function createStars() {
      const container = document.getElementById('starsContainer');
      for (let i = 0; i < 100; i++) {
        const star = document.createElement('div');
        star.className = 'star';
        star.style.left = Math.random() * 100 + '%';
        star.style.top = Math.random() * 100 + '%';
        star.style.width = Math.random() * 3 + 1 + 'px';
        star.style.height = star.style.width;
        star.style.animationDelay = Math.random() * 2 + 's';
        container.appendChild(star);
      }
    }
    
    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏ô‡∏ö‡∏¥‡∏ß‡∏•‡∏≤
    function createSpaceObjects() {
      gameState.planets = [];
      gameState.nebula = [];
      
      // ‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå
      for (let i = 0; i < 3; i++) {
        gameState.planets.push({
          x: Math.random() * W,
          y: Math.random() * (H/2),
          radius: Math.random() * 30 + 20,
          color: `hsl(${Math.random() * 360}, 70%, 60%)`,
          rotation: 0,
          rotSpeed: (Math.random() - 0.5) * 0.02
        });
      }
      
      // ‡πÄ‡∏ô‡∏ö‡∏¥‡∏ß‡∏•‡∏≤
      for (let i = 0; i < 5; i++) {
        gameState.nebula.push({
          x: Math.random() * W,
          y: Math.random() * H,
          radius: Math.random() * 50 + 30,
          color: `hsla(${Math.random() * 60 + 200}, 80%, 50%, 0.1)`,
          pulse: Math.random() * Math.PI * 2
        });
      }
    }
    
    const alienTypes = [
      { 
        color: "#ff3366", 
        size: 35, 
        speed: 1.8, 
        points: 60, 
        emoji: "üõ∏",
        name: "Scouter UFO"
      },
      { 
        color: "#8b00ff", 
        size: 40, 
        speed: 1.5, 
        points: 80, 
        emoji: "üëΩ",
        name: "Alien Fighter"
      },
      { 
        color: "#ff6600", 
        size: 45, 
        speed: 1.2, 
        points: 100, 
        emoji: "üöÄ",
        name: "War Ship"
      },
      { 
        color: "#00ff88", 
        size: 38, 
        speed: 2.2, 
        points: 90, 
        emoji: "‚ö°",
        name: "Energy Being"
      }
    ];
    
    const bossType = {
      color: "#ff0066",
      size: 80,
      speed: 0.8,
      points: 500,
      emoji: "üëæ",
      name: "MOTHERSHIP"
    };
    
    // ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏≠‡∏™
    const bossQuestionBank = [
      {
        text: "‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÉ‡∏ô‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß 340 m/s ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà 440 Hz ‡∏à‡∏á‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ñ‡∏•‡∏∑‡πà‡∏ô",
        v: 340, f: 440, answer: Math.round((340/440) * 100) / 100
      },
      {
        text: "‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÅ‡∏™‡∏á‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß 300,000 m/s ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà 600 Hz ‡∏à‡∏á‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ñ‡∏•‡∏∑‡πà‡∏ô",
        v: 300000, f: 600, answer: Math.round((300000/600) * 1) / 1
      },
      {
        text: "‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡∏ô‡πâ‡∏≥‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ñ‡∏•‡∏∑‡πà‡∏ô 2 m ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß 4 m/s ‡∏à‡∏á‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà",
        v: 4, lambda: 2, answer: Math.round((4/2) * 1) / 1, findF: true
      }
    ];
    
    function startGame() {
      gameState = {
        score: 0,
        lives: 5,
        frequency: 10,
        currentEnemy: null,
        answered: false,
        totalDefeated: 0,
        waves: [],
        particles: [],
        gameStarted: true,
        gameEnded: false,
        animTime: 0,
        bossMode: false,
        bossHealth: 3,
        bossQuestions: [],
        currentBossQuestion: 0,
        planets: gameState.planets || [],
        nebula: gameState.nebula || []
      };
      
      document.getElementById("gameScreen").innerHTML = "";
      createSpaceObjects();
      updateHUD();
      newEnemy();
      gameLoop();
    }
    
    function newEnemy() {
      gameState.answered = false;
      
      // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡∏ß‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏≠‡∏™‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
      if (gameState.totalDefeated > 0 && gameState.totalDefeated % 10 === 0 && !gameState.bossMode) {
        startBossMode();
        return;
      }
      
      const vList = [100, 150, 200, 300, 250, 180, 220, 280];
      const v = vList[Math.floor(Math.random() * vList.length)];
      const lambda = Math.round(v / gameState.frequency);
      
      const startSide = Math.random();
      let x, y, targetX, targetY;
      
      if (startSide < 0.33) {
        x = -60; y = Math.random() * (H / 2) + 50;
      } else if (startSide < 0.66) {
        x = W + 60; y = Math.random() * (H / 2) + 50;
      } else {
        x = Math.random() * W; y = -60;
      }
      
      targetX = Math.random() * (W - 200) + 100;
      targetY = Math.random() * (H / 2) + 100;
      
      const type = alienTypes[Math.floor(Math.random() * alienTypes.length)];
      
      gameState.currentEnemy = { 
        x, y, targetX, targetY, v, lambda,
        alive: true, ...type,
        angle: 0, movePhase: 0, isMoving: true,
        shields: Math.random() > 0.7
      };
      
      updateHUD();
      makeChoices(lambda);
    }
    
    function startBossMode() {
      gameState.bossMode = true;
      gameState.bossHealth = 3;
      gameState.currentBossQuestion = 0;
      
      // ‡∏™‡∏∏‡πà‡∏°‡πÇ‡∏à‡∏ó‡∏¢‡πå 3 ‡∏Ç‡πâ‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏≠‡∏™
      gameState.bossQuestions = [];
      for (let i = 0; i < 3; i++) {
        const q = bossQuestionBank[Math.floor(Math.random() * bossQuestionBank.length)];
        gameState.bossQuestions.push({...q});
      }
      
      const type = bossType;
      gameState.currentEnemy = {
        x: W/2, y: 100, targetX: W/2, targetY: 100,
        v: gameState.bossQuestions[0].v,
        lambda: gameState.bossQuestions[0].answer,
        alive: true, ...type,
        angle: 0, movePhase: 0, isMoving: false,
        isBoss: true,
        pulsePhase: 0
      };
      
      showBossScreen();
    }
    
    function showBossScreen() {
      const gameScreen = document.getElementById("gameScreen");
      const currentQ = gameState.bossQuestions[gameState.currentBossQuestion];
      
      gameScreen.innerHTML = `
        <div class="screen-overlay boss-screen">
          <h2>‚öîÔ∏è BOSS BATTLE! ‚öîÔ∏è</h2>
          <h3>${gameState.currentEnemy.name}</h3>
          <div class="boss-health">
            <div class="boss-health-bar" style="width: ${(gameState.bossHealth/3)*100}%"></div>
          </div>
          <p>üíÄ HP: ${gameState.bossHealth}/3</p>
          
          <div class="boss-questions">
            <div class="question">
              <h4>üìö ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Ç‡πâ‡∏≠ ${gameState.currentBossQuestion + 1}/3:</h4>
              <p>${currentQ.text}</p>
              ${currentQ.findF ? 
                '<div class="formula">f = v / Œª</div>' : 
                '<div class="formula">Œª = v / f</div>'
              }
            </div>
          </div>
          
          <div id="bossControls"></div>
          <button class="btn" onclick="closeBossScreen()">‚öîÔ∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ!</button>
        </div>
      `;
      
      makeBossChoices();
    }
    
    function makeBossChoices() {
      const container = document.getElementById("bossControls");
      const currentQ = gameState.bossQuestions[gameState.currentBossQuestion];
      const correct = currentQ.answer;
      
      let choices = [correct];
      while (choices.length < 4) {
        let wrong = correct * (0.5 + Math.random() * 1.5);
        wrong = Math.round(wrong * 100) / 100;
        if (wrong <= 0 || choices.some(c => Math.abs(c - wrong) < 0.01)) continue;
        choices.push(wrong);
      }
      choices.sort(() => Math.random() - 0.5);
      
      container.innerHTML = "";
      for (let val of choices) {
        const btn = document.createElement("button");
        btn.textContent = currentQ.findF ? `f = ${val} Hz` : `Œª = ${val} m`;
        btn.className = "btn";
        btn.onclick = () => checkBossAnswer(val, correct, btn);
        container.appendChild(btn);
      }
    }
    
    function checkBossAnswer(val, correct, btn) {
      if (gameState.answered) return;
      gameState.answered = true;
      
      const buttons = document.querySelectorAll('#bossControls .btn');
      buttons.forEach(b => {
        if (Math.abs(parseFloat(b.textContent.split(' = ')[1]) - correct) < 0.01) {
          b.classList.add("correct");
        } else if (b === btn && Math.abs(val - correct) >= 0.01) {
          b.classList.add("wrong");
        }
      });
      
      if (Math.abs(val - correct) < 0.01) {
        gameState.bossHealth--;
        gameState.score += 150;
        createExplosion(gameState.currentEnemy.x, gameState.currentEnemy.y);
        
        if (gameState.bossHealth <= 0) {
          // ‡∏ö‡∏≠‡∏™‡∏ï‡∏≤‡∏¢
          setTimeout(() => {
            gameState.currentEnemy.alive = false;
            gameState.bossMode = false;
            gameState.totalDefeated++;
            gameState.score += bossType.points;
            document.getElementById("gameScreen").innerHTML = "";
            setTimeout(newEnemy, 2000);
          }, 1500);
        } else {
          // ‡πÑ‡∏õ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ï‡πà‡∏≠‡πÑ‡∏õ
          gameState.currentBossQuestion++;
          setTimeout(() => {
            if (gameState.currentBossQuestion < 3) {
              gameState.answered = false;
              showBossScreen();
            }
          }, 1500);
        }
      } else {
        gameState.lives--;
        gameState.score -= 25;
        if (gameState.lives <= 0) {
          gameOver();
          return;
        }
        setTimeout(() => {
          gameState.answered = false;
          showBossScreen();
        }, 2000);
      }
      updateHUD();
    }
    
    function closeBossScreen() {
      document.getElementById("gameScreen").innerHTML = "";
    }
    
    function makeChoices(correct) {
      if (gameState.bossMode) return;
      
      const container = document.getElementById("controls");
      container.innerHTML = "";
      let choices = [correct];
      while (choices.length < 4) {
        let wrong = correct + (Math.floor(Math.random() * 10) - 5) * 2;
        if (wrong <= 0 || choices.includes(wrong)) continue;
        choices.push(wrong);
      }
      choices.sort(() => Math.random() - 0.5);
      for (let val of choices) {
        const btn = document.createElement("button");
        btn.textContent = "Œª = " + val + " m";
        btn.className = "btn";
        btn.onclick = () => checkAnswer(val, correct, btn);
        container.appendChild(btn);
      }
    }
    
    function checkAnswer(val, correct, btn) {
      if (gameState.answered || gameState.bossMode) return;
      gameState.answered = true;
      
      const buttons = document.querySelectorAll('.btn');
      buttons.forEach(b => {
        if (b.textContent.includes(correct + "")) {
          b.classList.add("correct");
        } else if (b === btn && val !== correct) {
          b.classList.add("wrong");
        }
      });
      
      if (val === correct) {
        gameState.score += gameState.currentEnemy.points;
        gameState.totalDefeated++;
        gameState.currentEnemy.isMoving = false;
        fireWave();
        setTimeout(() => {
          if (gameState.totalDefeated % 5 === 0) {
            const fs = [10, 15, 20, 25, 30, 12, 18, 22];
            gameState.frequency = fs[Math.floor(gameState.totalDefeated / 5) % fs.length] || 10;
          }
          if (gameState.currentEnemy && !gameState.currentEnemy.alive) {
            setTimeout(newEnemy, 1000);
          }
        }, 1500);
      } else {
        gameState.score -= 20;
        gameState.lives--;
        if (gameState.lives <= 0) {
          gameOver();
          return;
        }
        setTimeout(() => newEnemy(), 2000);
      }
      updateHUD();
    }
    
    function fireWave() {
      if (!gameState.currentEnemy) return;
      const dx = gameState.currentEnemy.x - ROCKET_X;
      const dy = gameState.currentEnemy.y - ROCKET_Y;
      const angle = Math.atan2(dy, dx);
      gameState.waves.push({
        x: ROCKET_X,
        y: ROCKET_Y,
        angle: angle,
        speed: 8,
        phase: 0,
        trail: [],
        energy: 100
      });
    }
    
    function updateHUD() {
      document.getElementById("score").textContent = gameState.score;
      document.getElementById("lives").textContent = gameState.lives;
      document.getElementById("waveCount").textContent = Math.floor(gameState.totalDefeated / 10) + 1;
      document.getElementById("totalDefeated").textContent = gameState.totalDefeated;
    }
    
    function gameOver() {
      gameState.gameEnded = true;
      gameState.gameStarted = false;
      const gameScreen = document.getElementById("gameScreen");
      gameScreen.innerHTML = `
        <div class="screen-overlay">
          <h2>üíÄ Mission Failed! üíÄ</h2>
          <p>üéØ Final Score: ${gameState.score}</p>
          <p>üëæ Aliens Defeated: ${gameState.totalDefeated}</p>
          <p>üåå Waves Survived: ${Math.floor(gameState.totalDefeated / 10) + 1}</p>
          
          <div class="knowledge-panel">
            <h3>üìö ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏•‡∏∑‡πà‡∏ô</h3>
            <p><strong>‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?</strong> ‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏£‡πà‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏™‡∏≤‡∏£ ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢‡∏™‡∏™‡∏≤‡∏£‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢</p>
            
            <div class="formula">Œª = v / f</div>
            <p><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£:</strong></p>
            <ul style="text-align: left;">
              <li><strong>Œª (‡∏•‡∏≥‡∏ö‡∏î‡∏≤)</strong> = ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ñ‡∏•‡∏∑‡πà‡∏ô (‡πÄ‡∏°‡∏ï‡∏£)</li>
              <li><strong>v</strong> = ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏Ñ‡∏•‡∏∑‡πà‡∏ô (‡πÄ‡∏°‡∏ï‡∏£/‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)</li>
              <li><strong>f</strong> = ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà (‡πÄ‡∏Æ‡∏¥‡∏£‡∏ï‡∏ã‡πå)</li>
            </ul>
            
            <p><strong>‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£:</strong> ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡∏à‡∏∞‡∏™‡∏±‡πâ‡∏ô‡∏•‡∏á ‡πÅ‡∏•‡∏∞‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏Å‡∏±‡∏ô</p>
          </div>
          
          <button class="btn" onclick="startGame()">üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡πÉ‡∏´‡∏°‡πà</button>
        </div>
      `;
    }
    
    function showStartScreen() {
      const gameScreen = document.getElementById("gameScreen");
      gameScreen.innerHTML = `
        <div class="screen-overlay">
          <h2>üöÄ Space Wave Shooter üåå</h2>
          <p>üõ∏ ‡∏¢‡∏≤‡∏ô‡πÄ‡∏≠‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ö‡∏∏‡∏Å‡πÇ‡∏•‡∏Å! ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á‡πÇ‡∏•‡∏Å</p>
          
          <div class="knowledge-panel">
            <h3>üìö ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏•‡πà‡∏ô</h3>
            <div class="formula">Œª = v / f</div>
            <p><strong>‡∏™‡∏π‡∏ï‡∏£‡∏´‡∏•‡∏±‡∏Å:</strong> ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ñ‡∏•‡∏∑‡πà‡∏ô = ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏Ñ‡∏•‡∏∑‡πà‡∏ô √∑ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà</p>
            <p>üéØ <strong>‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô:</strong> ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ñ‡∏•‡∏∑‡πà‡∏ô (Œª) ‡∏à‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤ v ‡πÅ‡∏•‡∏∞ f ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î</p>
            <p>‚öîÔ∏è <strong>‡∏ö‡∏≠‡∏™‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå:</strong> ‡∏ó‡∏∏‡∏Å 10 ‡∏ï‡∏±‡∏ß‡∏à‡∏∞‡∏°‡∏µ‡∏ö‡∏≠‡∏™‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≠‡∏ö 3 ‡πÇ‡∏à‡∏ó‡∏¢‡πå!</p>
          </div>
          
          <button class="btn" onclick="startGame()">üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à</button>
        </div>
      `;
    }
    
    function gameLoop() {
      if (!gameState.gameStarted || gameState.gameEnded) return;
      
      gameState.animTime += 0.016;
      ctx.clearRect(0, 0, W, H);
      
      // ‡∏ß‡∏≤‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏ß‡∏Å‡∏≤‡∏®
      drawSpaceBackground();
      
      // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏î‡∏®‡∏±‡∏ï‡∏£‡∏π
      if (gameState.currentEnemy && gameState.currentEnemy.alive) {
        updateEnemy();
        drawEnemy();
      }
      
      // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏î‡∏Ñ‡∏•‡∏∑‡πà‡∏ô
      for (let i = gameState.waves.length - 1; i >= 0; i--) {
        updateWave(gameState.waves[i]);
        drawWave(gameState.waves[i]);
        
        if (gameState.waves[i].x < -100 || gameState.waves[i].x > W + 100 || 
            gameState.waves[i].y < -100 || gameState.waves[i].y > H + 100) {
          gameState.waves.splice(i, 1);
        }
      }
      
      // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏û‡∏≤‡∏£‡πå‡∏ï‡∏¥‡πÄ‡∏Ñ‡∏¥‡∏•
      updateParticles();
      
      // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏ô
      checkCollisions();
      
      // ‡∏ß‡∏≤‡∏î‡∏¢‡∏≤‡∏ô‡∏à‡∏£‡∏ß‡∏î
      drawRocket();
      
      requestAnimationFrame(gameLoop);
    }
    
    function drawSpaceBackground() {
      // ‡∏ß‡∏≤‡∏î‡πÄ‡∏ô‡∏ö‡∏¥‡∏ß‡∏•‡∏≤
      for (let nebula of gameState.nebula) {
        nebula.pulse += 0.02;
        const pulseSize = nebula.radius + Math.sin(nebula.pulse) * 10;
        const gradient = ctx.createRadialGradient(nebula.x, nebula.y, 0, nebula.x, nebula.y, pulseSize);
        gradient.addColorStop(0, nebula.color);
        gradient.addColorStop(1, 'transparent');
        ctx.fillStyle = gradient;
        ctx.beginPath();
        ctx.arc(nebula.x, nebula.y, pulseSize, 0, Math.PI * 2);
        ctx.fill();
      }
      
